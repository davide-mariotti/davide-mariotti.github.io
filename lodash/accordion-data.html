<!DOCTYPE html>
<html>
<head>
  <title>Filter and Display Data</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js"></script>
  <script>
    //data
    const data = [
      { name: 'John', age: 25, city: 'New York', gender: 'male', job: 'engineer' },
      { name: 'Jane', age: 30, city: 'Los Angeles', gender: 'female', job: 'teacher' },
      { name: 'Bob', age: 35, city: 'Chicago', gender: 'male', job: 'scientist' },
      { name: 'Alice', age: 40, city: 'Houston', gender: 'female', job: 'doctor' },
      { name: 'Mike', age: 28, city: 'Philadelphia', gender: 'male', job: 'engineer' },
    ];

    //filters
    const ageCheckbox = document.getElementById('filter-age');
    const citySelect = document.getElementById('filter-city');
    const genderSelect = document.getElementById('filter-gender');
    const jobSelect = document.getElementById('filter-job');

    //result container
    const resultContainer = document.getElementById('result');

    //filter function
    function filterData() {
        let filteredData = data;

//filter by age
if (ageCheckbox.checked) {
  filteredData = _.filter(filteredData, item => item.age > 30);
}

//filter by city
if (citySelect.value !== 'all') {
  filteredData = _.filter(filteredData, item => item.city === citySelect.value);
}

//filter by gender
if (genderSelect.value !== 'all') {
  filteredData = _.filter(filteredData, item => item.gender === genderSelect.value);
}

//filter by job
if (jobSelect.value !== 'all') {
  filteredData = _.filter(filteredData, item => item.job === jobSelect.value);
}

//display filtered data in accordion
let accordionHTML = '';
if (filteredData.length > 0) {
  filteredData.forEach(item => {
    accordionHTML += `
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapse${item.name}">
              ${item.name}
            </button>
          </h5>
        </div>
        <div id="collapse${item.name}" class="collapse">
          <div class="card-body">
            <div>Age: ${item.age}</div>
            <div>City: ${item.city}</div>
            <div>Gender: ${item.gender}</div>
            <div>Job: ${item.job}</div>
          </div>
        </div>
      </div>
    `;
  });
  resultContainer.innerHTML = accordionHTML;
} else {
  resultContainer.innerHTML = '<p>No data matched the filters</p>';
}
}

//add event listeners to filters
ageCheckbox.addEventListener('change', filterData);
citySelect.addEventListener('change', filterData);
genderSelect.addEventListener('change', filterData);
jobSelect.addEventListener('change', filterData);
//initialize accordion
$(document).ready(function() {
      $('.collapse').collapse();
    });
    
    //display all data on first load
    filterData();
  </script>
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-sm-4">
        <div class="form-group">
          <input type="checkbox" class="form-control" id="filter-age">
          <label for="filter-age">Filter by age > 30</label>
        </div>
        <div class="form-group">
          <label for="filter-city">Filter by city</label>
          <select class="form-control" id="filter-city">
            <option value="all">All</option>
            <option value="New York">New York</option>
            <option value="Los Angeles">Los Angeles</option>
            <option value="Chicago">Chicago</option>
            <option value="Houston">Houston</option>
            <option value="Philadelphia">Philadelphia</option>
          </select>
        </div>
        <div class="form-group">
          <label for="filter-gender">Filter by Gender</label>
          <select class="form-control" id="filter-gender">
            <option value="all">All</option>
            <option value="male">male</option>
            <option value="female">female</option>
          </select>
        </div>
        <div class="form-group">
          <label for="filter-job">Filter by Job</label>
          <select class="form-control" id="filter-job">
            <option value="all">All</option>
            <option value="engineer">engineer</option>
            <option value="teacher">teacher</option>
            <option value="doctor">doctor</option>
            <option value="scientist">scientist</option>
          </select>
        </div>
      </div>
    
      <div class="col-sm-8">
        <div id="result" class="result-container"></div>
      </div>
    </div>
  </div>
  <style>
    .container {
    margin-top: 50px;
    background-color: #c3c3c3;
    padding: 30px;
    border-radius: 20px;
}
.form-group {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-bottom: 20px;
}
.form-group label{
    margin-left: 10px;
    margin-bottom: 0px;
}
.form-group .form-control{
    width: auto;
    margin-left: 10px;
}
.result-item {
    border-bottom: 2px solid #838383;
	margin-bottom: 15px;
	padding-bottom: 15px;
    display: flex;
	flex-direction: row;
	align-items: center;
}
.result-subitem {
    padding-left: 10px;
    border-left: 1px solid #838383;
    margin-left: 10px;
}
.result-subitem:first-child {
    padding-left: 0px;
    border-left: 0px;
    margin-left: 0px;
}
  </style>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>